var rpress_scripts,placeSearch,autocomplete;jQuery(document).ready(function(e){function r(e,r,s){var t=new Date;t.setTime(t.getTime()+24*s*60*60*1e3);var a="expires="+t.toUTCString();document.cookie=e+"="+r+"; "+a+";path=/"}function s(e){for(var r=e+"=",s=document.cookie.split(";"),t=0;t<s.length;t++){for(var a=s[t];" "==a.charAt(0);)a=a.substring(1);if(-1!=a.indexOf(r))return a.substring(r.length,a.length)}return""}if(e(".rpress-no-js").hide(),e("a.rpress-add-to-cart").addClass("rpress-has-js"),e(".rpress-sidebar-cart").on("click",".rpress-remove-from-cart",function(r){var s=e(this),t=s.data("cart-item"),a=s.data("action"),o=s.data("fooditem-id"),i={action:a,cart_item:t};return e.ajax({type:"POST",data:i,dataType:"json",url:rpress_scripts.ajaxurl,xhrFields:{withCredentials:!0},success:function(r){r.removed&&(console.log(),e(".rpress-cart .rpress-cart-item").each(function(){e(this).find("[data-cart-item='"+t+"']").parents(".rpress-cart-item").remove()}),e(".rpress-cart >li.rpress-cart-item").each(function(){var r=e(this).data("cart-key");e(this).find("[data-cart-item]").each(function(){e(this).attr("data-cart-item",r)})}),e("[id^=rpress_purchase_"+o+"]").length&&(e("[id^=rpress_purchase_"+o+"] .rpress_go_to_checkout").hide(),e("[id^=rpress_purchase_"+o+"] a.rpress-add-to-cart").show().removeAttr("data-rpress-loading"),"1"==rpress_scripts.quantities_enabled&&e("[id^=rpress_purchase_"+o+"] .rpress_fooditem_quantity_wrapper").show()),e("span.rpress-cart-quantity").text(r.cart_quantity),e(document.body).trigger("rpress_quantity_updated",[r.cart_quantity]),rpress_scripts.taxes_enabled&&(e(".cart_item.rpress_subtotal span").html(r.subtotal),e(".cart_item.rpress_cart_tax span").html(r.tax)),e(".cart_item.rpress_total span").html(r.total),0==r.cart_quantity&&(e(".cart_item.rpress_subtotal,.rpress-cart-number-of-items,.cart_item.rpress_checkout,.cart_item.rpress_cart_tax,.cart_item.rpress_total").hide(),e(".rpress-cart").each(function(){var r=e(this).parent();r&&(r.addClass("cart-empty"),r.removeClass("cart-not-empty")),e(this).append('<li class="cart_item empty hello">'+rpress_scripts.empty_cart_message+"</li>")})),e(document.body).trigger("rpress_cart_item_removed",[r]),0==e("li.rpress-cart-item").length&&(e("li.delivery-items-options").hide(),e("a.rpress-clear-cart").hide()))}}).fail(function(e){window.console&&window.console.log}).done(function(e){}),!1}),e(".rpress-add-to-cart").click(function(r){var t,a=(t=s("deliveryMethod"),s("deliveryTime"),null!=typeof t&&""!=t);if(e("#rpressModal").removeClass("rpress-delivery-options"),e("#rpressModal").removeClass("rpress-food-options"),e("#rpressModal .qty").val(1),a)o="rpress_show_products",i="rpress-food-options";else{var o="rpress_show_delivery_options",i="rpress-delivery-options";1==rpress_scripts.check_delivery_fee_enabled&&setTimeout(function(){initAutocomplete()},"2000")}r.preventDefault();var p=e(this),n=p.attr("data-fooditem-id"),d=p.attr("data-price"),l={action:o=o,fooditem_id:n,fooditem_price:d};return e.fancybox.open({type:"html",afterShow:function(e,r){e.showLoading(r)}}),e.ajax({type:"POST",data:l,dataType:"json",url:rpress_scripts.ajaxurl,xhrFields:{withCredentials:!0},success:function(r){e.fancybox.close(!0),e("#rpressModal .modal-title").html(r.data.html_title),e("#rpressModal .modal-body").html(r.data.html),e("#rpressModal").addClass(i),""!==n&&""!==d&&(e("#rpressModal").find(".submit-fooditem-button").attr("data-item-id",n),e("#rpressModal").find(".submit-fooditem-button").attr("data-item-price",d),e("#rpressModal").find(".submit-fooditem-button").attr("data-item-qty",1)),e("#rpressModal").find(".submit-fooditem-button").attr("data-cart-action","add-cart"),e("#rpressModal").find(".submit-fooditem-button").text(rpress_scripts.add_to_cart),e("#rpressModal").modal(),e(".rpress-tabs-wrapper").length&&e("#rpressdeliveryTab > li:first-child > a")[0].click()}}),!1}),e("body").on("click",".rpress-delivery-options li.nav-item",function(r){r.preventDefault(),e(this).parents(".rpress-delivery-wrap").find(".rpress-order-time-error").addClass("hide")}),e("body").on("click",".rpress-delivery-opt-update",function(t){t.preventDefault();var a=e(this),o=(e(this).text(),e(this).attr("data-food-id")),i=a.parents(".rpress-tabs-wrapper").find(".nav-item.active a").attr("data-delivery-type"),p=a.parents(".rpress-tabs-wrapper").find(".delivery-settings-wrapper.active .rpress-hrs").val(),n=a.parents(".rpress-tabs-wrapper").find(".delivery-settings-wrapper.active .rpress_get_delivery_dates").val();if(a.parents(".rpress-delivery-wrap").find(".rpress-errors-wrap").hasClass("holiday"))return!1;if(""==n)return a.parents(".rpress-delivery-wrap").find(".rpress-errors-wrap").text("Please select date for "+i),a.parents(".rpress-delivery-wrap").find(".rpress-errors-wrap").removeClass("disabled").addClass("enable"),!1;if(""==p)return a.parents(".rpress-delivery-wrap").find(".rpress-errors-wrap").text("Please select time for "+i),a.parents(".rpress-delivery-wrap").find(".rpress-errors-wrap").removeClass("disabled").addClass("enable"),!1;if(a.parents(".rpress-delivery-wrap").find(".rpress-errors-wrap").removeClass("enable").addClass("disabled"),a.text(rpress_scripts.please_wait),r("deliveryMethod",i,1),r("deliveryTime",p,1),r("DeliveryDate",n,1),o)e("#rpressModal").modal("hide"),e(".rpress-add-to-cart").each(function(){e(this).attr("data-fooditem-id")==o&&e(this).trigger("click")});else{i=s("deliveryMethod"),p=s("deliveryTime");""!==i&&""!==p&&(e(".delivery-items-options").find(".delivery-opts").html('<span class="delMethod">'+i+'</span> <span class="delTime"> at '+p+"</span>"),e("#rpressModal").modal("hide"))}}),e("#rpress_checkout_form_wrap").on("click",".rpress_checkout_register_login",function(){var r={action:e(this).data("action")};return e(".rpress-cart-ajax").show(),e.post(rpress_scripts.ajaxurl,r,function(r){e("#rpress_checkout_login_register").html(rpress_scripts.loading),e("#rpress_checkout_login_register").html(r),e(".rpress-cart-ajax").hide()}),!1}),e(document).on("click","#rpress_purchase_form #rpress_login_fields input[type=submit]",function(r){r.preventDefault();var s=e(this).val();e(this).val(rpress_global_vars.purchase_loading),e(this).after('<span class="rpress-loading-ajax rpress-loading"></span>');var t={action:"rpress_process_checkout_login",rpress_ajax:1,rpress_user_login:e("#rpress_login_fields #rpress_user_login").val(),rpress_user_pass:e("#rpress_login_fields #rpress_user_pass").val()};e.post(rpress_global_vars.ajaxurl,t,function(r){"success"==e.trim(r)?(e(".rpress_errors").remove(),window.location=rpress_scripts.checkout_page):(e("#rpress_login_fields input[type=submit]").val(s),e(".rpress-loading-ajax").remove(),e(".rpress_errors").remove(),e("#rpress-user-login-submit").before(r))})}),e("select#rpress-gateway, input.rpress-gateway").change(function(r){var s=e("#rpress-gateway option:selected, input.rpress-gateway:checked").val();return"0"!=s&&(rpress_load_gateway(s),!1)}),"1"==rpress_scripts.is_checkout){var t=!1,a=!1;e("select#rpress-gateway, input.rpress-gateway").length&&(t=e("meta[name='rpress-chosen-gateway']").attr("content"),a=!0),t||(t=rpress_scripts.default_gateway),a?setTimeout(function(){rpress_load_gateway(t)},200):e("body").trigger("rpress_gateway_loaded",[t])}e("body").on("click",".delivery-change",function(r){r.preventDefault();e("#rpressModal").removeClass("rpress-food-options"),e("#rpressModal").removeClass("rpress-delivery-options");var t={action:"rpress_show_delivery_options",changedate:"yes"};return e.fancybox.open({type:"html",afterShow:function(e,r){e.showLoading(r)}}),e.ajax({type:"POST",data:t,dataType:"json",url:rpress_scripts.ajaxurl,xhrFields:{withCredentials:!0},success:function(r){e.fancybox.close(!0),e("#rpressModal .modal-title").html(r.data.html_title),e("#rpressModal").addClass("rpress-delivery-options"),e("#rpressModal .modal-body").html(r.data.html),e("#rpressModal").modal();var t=s("deliveryMethod"),a=s("deliveryTime"),o=s("DeliveryDate");""===t&&void 0===t||(e(".rpress-delivery-wrap").find(".rpress-pickup").val(a),e(".rpress-delivery-wrap").find(".rpress-delivery").val(a),e(".rpress-delivery-wrap").find(".rpress-delivery-time-wrap").show(),e(".rpress-delivery-wrap").find(".rpress-pickup-time-wrap").show()),""===o&&null==o||e(".rpress-delivery-wrap").find(".rpress_get_delivery_dates").val(o);var i=new Date;i.setDate(i.getDate()),e(".rpress-tabs-wrapper").length&&e(".rpress-delivery-wrap").find("a#nav-"+t+"-tab").trigger("click")}}),!1}),e(document).on("click","#rpress_purchase_form #rpress_purchase_submit [type=submit]",function(r){var s=document.getElementById("rpress_purchase_form");if("function"!=typeof s.checkValidity||!1!==s.checkValidity()){r.preventDefault();var t=e(this).val();e(this).val(rpress_global_vars.purchase_loading),e(this).prop("disabled",!0),e(this).after('<span class="rpress-loading-ajax rpress-loading"></span>'),e.post(rpress_global_vars.ajaxurl,e("#rpress_purchase_form").serialize()+"&action=rpress_process_checkout&rpress_ajax=true",function(r){"success"==e.trim(r)?(e(".rpress_errors").remove(),e(".rpress-error").hide(),e(s).submit()):(e("#rpress-purchase-button").val(t),e(".rpress-loading-ajax").remove(),e(".rpress_errors").remove(),e(".rpress-error").hide(),e(rpress_global_vars.checkout_error_anchor).before(r),e("#rpress-purchase-button").prop("disabled",!1),e(document.body).trigger("rpress_checkout_error",[r]))})}}),e(document.body).on("change","#rpress_cc_address input.card_state, #rpress_cc_address select, #rpress_address_country",function(){var r,s=e(this),t="undefined"!=typeof rpress_global_vars,a="card_state";"rpress_address_country"==e(this).attr("id")&&(a="rpress_address_state");if("card_state"!=s.attr("id")){var o={action:"rpress_get_shop_states",country:s.val(),field_name:a};e.ajax({type:"POST",data:o,url:rpress_scripts.ajaxurl,xhrFields:{withCredentials:!0},success:function(a){r=t?e("#rpress_purchase_form"):s.closest("form");var o='input[name="card_state"], select[name="card_state"], input[name="rpress_address_state"], select[name="rpress_address_state"]';if("nostates"==e.trim(a)){r.find(o).replaceWith('<input type="text" name="card_state" class="card-state rpress-input required" value=""/>')}else r.find(o).replaceWith(a);t&&e(document.body).trigger("rpress_cart_billing_address_updated",[a])}}).fail(function(e){window.console&&window.console.log&&console.log(e)}).done(function(e){t&&recalculate_taxes()})}else t&&recalculate_taxes();return!1}),e(document.body).on("change","#rpress_cc_address input[name=card_zip]",function(){"undefined"!=typeof rpress_global_vars&&recalculate_taxes()})});var componentForm={street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",country:"short_name",postal_code:"short_name"};function initAutocomplete(){(autocomplete=new google.maps.places.Autocomplete(document.getElementsByClassName("autocomplete")[0],{types:["geocode"]})).addListener("place_changed",fillInAddress)}function fillInAddress(){var e=autocomplete.getPlace(),r=e.geometry.location.lat()+"-"+e.geometry.location.lng();jQuery("#rpress_geo_address").val(r)}function geolocate(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var r={lat:e.coords.latitude,lng:e.coords.longitude},s=new google.maps.Circle({center:r,radius:e.coords.accuracy});autocomplete.setBounds(s.getBounds())})}function rpress_load_gateway(e){jQuery(".rpress-cart-ajax").show(),jQuery("#rpress_purchase_form_wrap").html('<span class="rpress-loading-ajax rpress-loading"></span>');var r=rpress_scripts.ajaxurl;r.indexOf("?")>0?r+="&":r+="?",r=r+"payment-mode="+e,jQuery.post(r,{action:"rpress_load_gateway",rpress_payment_mode:e},function(r){jQuery("#rpress_purchase_form_wrap").html(r),jQuery(".rpress-no-js").hide(),jQuery("body").trigger("rpress_gateway_loaded",[e])})}